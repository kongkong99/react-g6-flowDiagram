(this["webpackJsonpcra-template"]=this["webpackJsonpcra-template"]||[]).push([[5],{553:function(e,t,n){e.exports={"graph-container":"graph-container__1rFgy4GXGo"}},563:function(e,t,n){"use strict";n.r(t);var o,a=n(172),r=n.n(a),i=n(248),d=n(75),s=n(76),c=n(109),u=n(108),l=n(0),h=n.n(l),p=n(259),g=n(6),f=n(551),m=n.n(f),v=n(238),b=n(553),y=n.n(b),E=n(560),k=new(function(){function e(){Object(d.a)(this,e),this.subs={}}return Object(s.a)(e,[{key:"$on",value:function(e,t){this.subs[e]=this.subs[e]||[],this.subs[e].push(t)}},{key:"$emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];this.subs[e]=this.subs[e]||[],this.subs[e].forEach((function(e){e.apply(void 0,n)}))}}]),e}()),x=null,w=!1,M=null,j=null,I=[],O={"add-edge":{getEvents:function(){return{mousedown:"onMousedown",mouseup:"onMouseup",mousemove:"onMousemove","node:mouseenter":"nodeMouseEnter"}},onMousedown:function(e){e.stopPropagation();var t=e.item.getModel();M=t.id,w||(k.$emit("addingEdge",!0),this.graph.getNodes().forEach((function(e){var t=e.getContainer().find((function(e){return"node-topPoint"===e.get("name")}));I.push(t),t.attr("opacity",1)})),x=this.graph.addItem("edge",{source:M,target:M,sourceAnchor:1}),w=!0)},onMouseup:function(e){e.stopPropagation();var t=e.item;if("node"===t.getType()&&w&&x){var n=t.getModel();j=n.id,-1!==this.graph.save().edges.findIndex((function(e){return e.source===M&&e.target===j}))?this.graph.removeItem(x):this.graph.updateItem(x,{target:j,targetAnchor:0})}"node"!==t.getType()&&this.graph.removeItem(x),I.forEach((function(e){e.attr("opacity",0)})),k.$emit("addingEdge",!1),I=[],w=!1,x=null,"default"!==this.graph.getCurrentMode()&&this.graph.setMode("default")},onMousemove:function(e){if(w&&x){var t={x:e.x,y:e.y};this.graph.updateItem(x,{target:t})}},nodeMouseEnter:function(){}}},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:150,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;m.a.registerNode("custom-node",{draw:function(n,o){var a=o.addShape("rect",{attrs:{x:0,y:0,width:e,height:t,stroke:"blue",fill:"#fff",radius:4,cursor:"move"},name:"node-rect-keyShape"});return o.addShape("text",{attrs:{text:n.label,x:19,y:19,fontSize:14,fontWeight:700,textAlign:"left",textBaseline:"middle",fill:"blue",cursor:"move"},draggable:!0,name:"node-text"}),o.addShape("circle",{attrs:{x:e/2,y:0,r:5,fill:"#fff",stroke:"blue",opacity:0},name:"node-topPoint"}),o.addShape("circle",{attrs:{x:e/2,y:t,r:5,fill:"#fff",stroke:"blue",opacity:0,cursor:"crosshair"},name:"node-bottomPoint"}),a},afterDraw:function(e,t){var n=t.find((function(e){return"node-bottomPoint"===e.get("name")}));n&&(n.on("mouseenter",(function(){n.attr("fill","blue")})),n.on("mouseleave",(function(){n.attr({fill:"#fff"})})),n.on("mousedown",(function(e){k.$emit("bottomPointMousedown")})))}},"rect")},S=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var o;return Object(d.a)(this,n),(o=t.call(this,e)).graph=null,o.graphId="graph-container",o.selectedNode=null,o.hoverNode=null,o.addingEdge=!1,o.state={},o.data={},o}return Object(s.a)(n,[{key:"componentDidMount",value:function(){N(),Object.entries(O).forEach((function(e){var t=Object(E.a)(e,2),n=t[0],o=t[1];m.a.registerBehavior(n,o)})),this.init(),this.bindEvent()}},{key:"init",value:function(){this.graph=new m.a.Graph({container:this.graphId,width:1e3,height:500,fitCenter:!0,defaultNode:{type:"custom-node",style:{}},defaultEdge:{type:"cubic-vertical",style:{stroke:"#5B8FF9",endArrow:!0,lineWidth:3}},modes:{default:["drag-canvas","drag-node"],addEdge:["add-edge"]},nodeStateStyles:{selected:{lineWidth:4,"node-text":{fill:"gray"},"node-bottomPoint":{opacity:1},"node-topPoint":{opacity:1}},hover:{lineWidth:2,"node-bottomPoint":{opacity:1},"node-topPoint":{opacity:1}}},edgeStateStyles:{hover:{stroke:"red"},selected:{lineWidth:8}}}),this.graph.read(this.data)}},{key:"bindEvent",value:function(){var e=this;this.graph.on("node:mouseenter",(function(t){var n=t.item;e.hoverNode=n,e.addingEdge||e.graph.setItemState(n,"hover",!0)})),this.graph.on("node:mouseleave",(function(t){var n=t.item;e.addingEdge||e.graph.setItemState(n,"hover",!1)})),this.graph.on("click",(function(){e.selectedNode&&(e.graph.setItemState(e.selectedNode,"selected",!1),e.selectedNode=null)})),this.graph.on("node:click",(function(t){var n=t.item;e.selectedNode=n,e.graph.setItemState(n,"selected",!0)})),k.$on("bottomPointMousedown",(function(){e.graph.setMode("addEdge")})),k.$on("addingEdge",(function(t){e.addingEdge=t,!t&&e.hoverNode&&(e.graph.setItemState(e.hoverNode,"hover",!1),e.hoverNode=null)}))}},{key:"addNode",value:function(){var e=Object(v.uniqueId)(),t={id:"rect".concat(e),label:"\u81ea\u5b9a\u4e49\u8282\u70b9rect".concat(e),x:350+100*Math.random(),y:50,anchorPoints:[[.5,0],[.5,1]]};this.graph.addItem("node",t)}},{key:"consoleData",value:function(){console.log(this.graph.save())}},{key:"render",value:function(){var e=this;return h.a.createElement("div",null,h.a.createElement("div",{style:{display:"flex",marginBottom:16}},h.a.createElement("button",{type:"button",onClick:function(){return e.addNode()}},"\u6dfb\u52a0\u8282\u70b9"),h.a.createElement("button",{type:"button",onClick:function(){return e.consoleData()},style:{marginLeft:24}},"\u6253\u5370\u6570\u636e(\u8f93\u51fa\u5728\u63a7\u5236\u53f0F12)")),h.a.createElement("div",{className:y.a["graph-container"],id:this.graphId}))}}]),n}(l.Component),P=Object(p.b)("list")(o=Object(p.c)(o=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(Object(g.q)(this.props.list)),t=this.props.list.getInterfaceList,e.t0=console,e.next=5,t();case 5:e.t1=e.sent,e.t0.log.call(e.t0,e.t1);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return h.a.createElement("div",{style:{textAlign:"center"}},h.a.createElement("div",{style:{display:"inline-block",marginTop:100}},h.a.createElement(S,null)))}}]),n}(l.Component))||o)||o;t.default=P}}]);